---
title: "Model"
format: html
execute:
  echo: FALSE
---

```{r}
#| label: setup
#| message: FALSE
#| warning: FALSE

library(tidyverse)
library(gtsummary)
library(brms)
library(primer.data)
```

```{r}
#| label: cleaning

# Cleaning out the data

x <- nes |> 
  filter(year == 2020) |> 
  select(pres_vote, region) |> 
  mutate(pres_vote = case_when(
    pres_vote == "Democrat" ~ "Biden",
    pres_vote == "Republican" ~ "Trump",
    pres_vote == "Third Party" ~ "Jorgensen"
  )) |>
  drop_na()

```

```{r}
#| label: model
#| warning: FALSE
#| cache: TRUE

# Running brm() to make the model

fit_elec_2020 <- brm(formula = pres_vote ~ region,
                data = x,
                family = categorical(),
                silent = 2,
                refresh = 0,
                seed = 9)
```

$$
\begin{aligned}
\rho_{biden}  &=& 1 - \rho_{trump} - \rho_{jorgensen}\\ 
\rho_{trump} &=& \frac{e^{-0.22 - 0.38 northeast + 0.15 south - 0.39 west}}{1 + e^{-0.22 - 0.38 northeast + 0.15 south - 0.39 west}}\\
\rho_{jorgensen} &=& \frac{e^{-3.4 - 0.49 northeast -0.24 south - 0.36 west}}{1 + e^{-3.4 - 0.49 northeast -0.24 south - 0.36 west}}\\
\end{aligned}
$$




```{r}
#| label: table
#| warning: FALSE

tbl_regression(fit_elec_2020)
```

